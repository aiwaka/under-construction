---
import type { MarkdownLayoutProps } from "astro";
import type { ArticleAttribute } from "@lib/articles";
import { dateText, thumbnailPath } from "@lib/utils";
import BlogGeneralLayout from "./BlogGeneralLayout.astro";
import ArticleTag from "@components/blog/ArticleTag.svelte";
import { Image } from "@astrojs/image/components";

type Props = MarkdownLayoutProps<ArticleAttribute>;

const { frontmatter } = Astro.props;
const ogp = {
  url: Astro.request.url,
  type: "blog",
  title: `Under Construction | blog | ${frontmatter.title}`,
  description: frontmatter.description,
  siteName: "Under Construction",
  // githubでデプロイするとここに保存されているようなのでこのようにする.
  image: thumbnailPath(frontmatter.thumbnail),
};
---

<BlogGeneralLayout
  ogp={ogp}
  title={frontmatter.title}
  usingLatex={frontmatter.latex}
>
  <h1>{frontmatter.title}</h1>
  <div class="date-block">
    <span>{dateText(new Date(frontmatter.date))}</span>
  </div>
  <div class="tag-container">
    {
      frontmatter.tags.map((tag) => {
        return <ArticleTag tag={tag} />;
      })
    }
  </div>
  <div class="img-container">
    <Image
      src={import(`../pages/blog/thumb/${frontmatter.thumbnail}.png`)}
      width={1024}
      alt="thumbnail"
      loading="eager"
    />
  </div>
  <div class="blog-article-content-container">
    <slot />
  </div>
</BlogGeneralLayout>

<style>
  .img-container {
    border: 4px solid var(--main-color);
    width: 100%;
    height: 45vh;
    clip: rect(0, 0, 0, 0);
    margin: 3rem auto;
  }
  .img-container > img {
    object-fit: cover;
    width: 100%;
    height: 100%;
  }
  .tag-container {
    display: flex;
    flex-wrap: wrap;
  }
  :global(.blog-article-content-container) {
    line-height: 2rem;
  }
  .blog-article-content-container :global(a) {
    color: darkgoldenrod;
  }
  .blog-article-content-container :global(a:hover) {
    color: orangered;
  }
  .blog-article-content-container :global(h2) {
    margin-top: 4rem;
    margin-bottom: 1.4rem;
  }
  .blog-article-content-container :global(h3) {
    margin-top: 2.5rem;
  }
  .blog-article-content-container :global(p) {
    margin: 1.7rem;
  }
  .blog-article-content-container :global(img) {
    width: 100%;
    height: auto;
  }
  .blog-article-content-container :global(ul) {
    margin-left: 2.7rem;
    padding-left: 2.7rem;
  }
</style>
