---
import { Image } from "@astrojs/image/components";
import type { ImageMetadata } from "@astrojs/image/dist/vite-plugin-astro-image";
import BlogImage from "./BlogImage.astro";

// TODO: タイプガードを使ってリストではないオブジェクト一個でも動くようにする.
interface ImageProps {
  src: ImageMetadata | Promise<{ default: ImageMetadata }>;
  width: number;
  alt: string;
  // TODO: キャプションがundefinedであればaltをそのまま用いるようにする
  caption?: string;
}
interface Props {
  list: ImageProps[];
}
const { list, ...attrs } = Astro.props;
---

{/* TODO: figureが入れ子になってしまっている. */}
<figure class="multi-image">
  {
    list.map((item) => {
      const { src, width, alt, caption } = item;
      return (
        <BlogImage
          src={src}
          width={width}
          alt={alt}
          caption={caption}
          {...attrs}
        />
      );
    })
  }
</figure>

<style>
  .multi-image {
    display: flex;
    flex-wrap: nowrap;
    align-items: center;
    @media (max-width: 1024px) {
      flex-direction: column;
    }
  }
</style>
